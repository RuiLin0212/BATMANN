# exp 1
CUDA_VISIBLE_DEVICES=1,2 python main_fgsm.py \
--log_dir ./log_ablation_fgsm/log_exp1 \
--data_dir /mnt/nfsdisk/jier/4_MANN/mann_hdv/data \
--input_channel 1 \
--feature_dim 512 \
--class_num 20 \
--num_shot 5 \
--pool_query_train 10 \
--pool_val_train 5 \
--batch_size_train 5 \
--val_num_train 3 \
--pool_query_test 15 \
--batch_size_test 5 \
--train_episode 10000 \
--log_interval 100 \
--val_episode 250 \
--val_interval 500 \
--test_episode 1000 \
--learning_rate 0.0001 \
--quantization_learn No \
--quantization_infer 1 \
--rotation_update 1 \
--a32 1 \
--test_only 1 \
--pretrained_dir ./log_ablation/log_exp1/model_best.pth.tar \
--sim_cal cos_softabs \
--binary_id 1 \
--epsilon 0.1 \
--gpu 1,2 \

# exp 2
CUDA_VISIBLE_DEVICES=0,1 python main_fgsm.py \
--log_dir ./log_ablation_fgsm/log_exp2 \
--data_dir /mnt/nfsdisk/jier/4_MANN/mann_hdv/data \
--input_channel 1 \
--feature_dim 512 \
--class_num 20 \
--num_shot 5 \
--pool_query_train 10 \
--pool_val_train 5 \
--batch_size_train 5 \
--val_num_train 3 \
--pool_query_test 15 \
--batch_size_test 5 \
--train_episode 10000 \
--log_interval 100 \
--val_episode 250 \
--val_interval 500 \
--test_episode 1000 \
--learning_rate 0.0001 \
--quantization_learn No \
--quantization_infer 1 \
--rotation_update 1 \
--a32 1 \
--test_only 1 \
--pretrained_dir ./log_ablation/log_exp2/model_best.pth.tar \
--sim_cal cos_softabs \
--binary_id 2 \
--epsilon 0.1 \
--gpu 0,1 \

# exp 3
CUDA_VISIBLE_DEVICES=0,1 python main_fgsm.py \
--log_dir ./log_ablation_fgsm/log_exp3 \
--data_dir /mnt/nfsdisk/jier/4_MANN/mann_hdv/data \
--input_channel 1 \
--feature_dim 512 \
--class_num 20 \
--num_shot 5 \
--pool_query_train 10 \
--pool_val_train 5 \
--batch_size_train 5 \
--val_num_train 3 \
--pool_query_test 15 \
--batch_size_test 5 \
--train_episode 10000 \
--log_interval 100 \
--val_episode 250 \
--val_interval 500 \
--test_episode 1000 \
--learning_rate 0.0001 \
--quantization_learn No \
--quantization_infer 1 \
--rotation_update 1 \
--a32 1 \
--test_only 1 \
--pretrained_dir ./log_ablation/log_exp3/model_best.pth.tar \
--sim_cal cos_softmax \
--binary_id 1 \
--epsilon 0.1 \
--gpu 0,1 \

# exp 4
CUDA_VISIBLE_DEVICES=0,1 python main_fgsm.py \
--log_dir ./log_ablation_fgsm/log_exp4 \
--data_dir /mnt/nfsdisk/jier/4_MANN/mann_hdv/data \
--input_channel 1 \
--feature_dim 512 \
--class_num 20 \
--num_shot 5 \
--pool_query_train 10 \
--pool_val_train 5 \
--batch_size_train 5 \
--val_num_train 3 \
--pool_query_test 15 \
--batch_size_test 5 \
--train_episode 10000 \
--log_interval 100 \
--val_episode 250 \
--val_interval 500 \
--test_episode 1000 \
--learning_rate 0.0001 \
--quantization_learn No \
--quantization_infer 1 \
--rotation_update 1 \
--a32 1 \
--test_only 1 \
--pretrained_dir ./log_ablation/log_exp4/model_best.pth.tar \
--sim_cal cos_softmax \
--binary_id 2 \
--epsilon 0.1 \
--gpu 0,1 \

# exp 5
CUDA_VISIBLE_DEVICES=0,1 python main_fgsm.py \
--log_dir ./log_ablation_fgsm/log_exp5 \
--data_dir /mnt/nfsdisk/jier/4_MANN/mann_hdv/data \
--input_channel 1 \
--feature_dim 512 \
--class_num 20 \
--num_shot 5 \
--pool_query_train 10 \
--pool_val_train 5 \
--batch_size_train 5 \
--val_num_train 3 \
--pool_query_test 15 \
--batch_size_test 5 \
--train_episode 10000 \
--log_interval 100 \
--val_episode 250 \
--val_interval 500 \
--test_episode 1000 \
--learning_rate 0.0001 \
--quantization_learn XNOR \
--quantization_infer 1 \
--rotation_update 1 \
--a32 1 \
--test_only 1 \
--pretrained_dir ./log_ablation/log_exp5/model_best.pth.tar \
--sim_cal cos_softabs \
--binary_id 1 \
--epsilon 0.1 \
--gpu 0,1 \

# exp 6
CUDA_VISIBLE_DEVICES=0,1 python main_fgsm.py \
--log_dir ./log_ablation_fgsm/log_exp6 \
--data_dir /mnt/nfsdisk/jier/4_MANN/mann_hdv/data \
--input_channel 1 \
--feature_dim 512 \
--class_num 20 \
--num_shot 5 \
--pool_query_train 10 \
--pool_val_train 5 \
--batch_size_train 5 \
--val_num_train 3 \
--pool_query_test 15 \
--batch_size_test 5 \
--train_episode 10000 \
--log_interval 100 \
--val_episode 250 \
--val_interval 500 \
--test_episode 1000 \
--learning_rate 0.0001 \
--quantization_learn XNOR \
--quantization_infer 1 \
--rotation_update 1 \
--a32 1 \
--test_only 1 \
--pretrained_dir ./log_ablation/log_exp6/model_best.pth.tar \
--sim_cal cos_softmax \
--binary_id 1 \
--epsilon 0.1 \
--gpu 0,1 \

# exp 7
CUDA_VISIBLE_DEVICES=0,1 python main_RBNN_fgsm.py \
--log_dir ./log_ablation_fgsm/log_exp7 \
--data_dir /mnt/nfsdisk/jier/4_MANN/mann_hdv/data \
--input_channel 1 \
--feature_dim 512 \
--class_num 20 \
--num_shot 5 \
--pool_query_train 10 \
--pool_val_train 5 \
--batch_size_train 5 \
--val_num_train 3 \
--pool_query_test 15 \
--batch_size_test 5 \
--train_episode 10000 \
--log_interval 100 \
--val_episode 250 \
--val_interval 500 \
--test_episode 1000 \
--learning_rate 0.0001 \
--quantization_learn RBNN \
--quantization_infer 1 \
--rotation_update 1 \
--a32 1 \
--test_only 1 \
--pretrained_dir ./log_ablation/log_exp7/model_best.pth.tar \
--sim_cal cos_softabs \
--binary_id 1 \
--epsilon 0.1 \
--gpu 0,1 \

# exp 8
CUDA_VISIBLE_DEVICES=0,1 python main_RBNN_fgsm.py \
--log_dir ./log_ablation_fgsm/log_exp8 \
--data_dir /mnt/nfsdisk/jier/4_MANN/mann_hdv/data \
--input_channel 1 \
--feature_dim 512 \
--class_num 20 \
--num_shot 5 \
--pool_query_train 10 \
--pool_val_train 5 \
--batch_size_train 5 \
--val_num_train 3 \
--pool_query_test 15 \
--batch_size_test 5 \
--train_episode 10000 \
--log_interval 100 \
--val_episode 250 \
--val_interval 500 \
--test_episode 1000 \
--learning_rate 0.0001 \
--quantization_learn RBNN \
--quantization_infer 1 \
--rotation_update 1 \
--a32 1 \
--test_only 1 \
--pretrained_dir ./log_ablation/log_exp8/model_best.pth.tar \
--sim_cal cos_softmax \
--binary_id 1 \
--epsilon 0.1 \
--gpu 0,1
